module Test.BN254 where

import Protolude

import Data.Curve.Weierstrass
import Data.Field.Galois
import Data.Pairing.BarretoNaehrig.BN254
import Test.Tasty
import Test.Tasty.HUnit
import Test.Tasty.QuickCheck

import Test.Pairing

testBN254 :: TestTree
testBN254 = localOption (QuickCheckTests 10) $ testGroup "BN254"
  [ groupPairingAxioms (witness :: BN254)
  , curvePairingAxioms (witness :: BN254)
  , testCase "Verify pairing" $
    pairing g1 g2 @?= gt
  ]

g1 :: G1 BN254
g1 = A
  1368015179489954701390400359078579693043519447331113978918064868415326638035
  9918110051302171585080402603319702774565515993150576347155970296011118125764

g2 :: G2 BN254
g2 = A
  ( toE' [ 2725019753478801796453339367788033689375851816420509565303521482350756874229
         , 7273165102799931111715871471550377909735733521218303035754523677688038059653
         ]
  )
  ( toE' [ 2512659008974376214222774206987427162027254181373325676825515531566330959255
         , 957874124722006818841961785324909313781880061366718538693995380805373202866
         ]
  )

gt :: GT BN254
gt = toU $
  toE' [ toE' [ toE' [ 7297928317524675251652102644847406639091474940444702627333408876432772026640
                     , 18010865284024443253481973710158529446817119443459787454101328040744995455319
                     ]
              , toE' [ 14179125828660221708486990054318233868908974550229474018509093903907472063156
                     , 19672547343219696395323430329000470270122259521813831378125910505067755316037
                     ]
              , toE' [ 10811020225621941034352015694422164943041584464746963243431262955968538467312
                     , 18591344525433923700278298641693487837785792806011751060570085671866249379154
                     ]
              ]
       , toE' [ toE' [ 18214296718386486500838507024306049626571830525675768493345345883297201451077
                     , 19227311731387426597265504864999881769743583647552324796732605660514141916117
                     ]
              , toE' [ 15463354980731838106439887363063618463783317416732018231077874458188347926701
                     , 3765441250413579779915094051038487360437654739171671492016287185303087270469
                     ]
              , toE' [ 21029416079740174485345021549306749850075185576152640151652655104272393297142
                     , 19736982780723093346009254617143639137054958583796054069884522103959451721163
                     ]
              ]
       ]
